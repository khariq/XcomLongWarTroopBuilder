<!DOCTYPE html>
<html ng-app="xcomApp">
<head>
    <title>XCOM: Long War - Troop Builder</title>

    <script src="scripts/linq.min.js" type="text/javascript"></script>
    <script src="scripts/jquery-2.1.1.min.js" type="text/javascript"></script>

    <script src="scripts/angular.min.js" type="text/javascript"></script>

    <link rel="stylesheet" href="css/bootstrap.min.css">
	<script src="scripts/bootstrap.min.js"></script>

    
</head>
<body id="xcomController" ng-controller="xcomController">

	<nav class="navbar navbar-default">
		<div class="container-fluid">
			<div class="navbar-header">
				<a class="navbar-brand" href="#">
					<img src="lw_header.png" alt="XCOM Long War" style="height: 24px;" />
				</a>
			</div>
			<!-- Collect the nav links, forms, and other content for toggling -->
			<div class="collapse navbar-collapse" id="navbar-collapse-1">
				<ul class="nav navbar-nav">
					<li role="presentation" ng-repeat="item in menuItems" ng-class="{ active: isActive(item.id)}">
						<a href="#{{item.id}}" ng-click="showClass(item.id)">
							{{item.name}}
						</a>
					</li>
				</ul>
			</div><!-- /.navbar-collapse -->
		</div><!-- /.container-fluid -->
	</nav>

	<div class="container-fluid" ng-hide="class == null">
		
		<div class="row">
			
			<div class="col-md-9">
				<div class="panel">
					<ul class="nav nav-pills nav-justified">
						<li role="presentation" ng-class="{active: visibleTab === 'perks'}" ><a href="#" ng-click="showTab('perks')" >{{class.name}} Perks</a></li>
						<li role="presentation" ng-class="{active: visibleTab === 'armory'}"><a href="#" ng-click="showTab('armory')">Armory</a></li>
						<li role="presentation" ng-class="{active: visibleTab === 'psionics'}"><a href="#" ng-click="showTab('psionics')">Psionics</a></li>
						<li role="presentation" ng-class="{active: visibleTab === 'gene'}"><a href="#" ng-click="showTab('gene')">Gene Mods</a></li>
					</ul>
					
					<div class="panel-body" ng-show="visibleTab === 'perks'">
						
						<div class="row" ng-repeat="perk in perks" style="padding: 2px;">
							<div class="col-sm-3">
								{{ranks[$index].name}}
							</div>
							<div class="col-sm-9">

								<div class="btn-group btn-group-justified" role="group">
									
									<div class="btn-group" data-toggle="buttons" ng-repeat="perkDetails in perk">
								
										<label class="btn btn-default" ng-mouseover="showDetails(perkDetails)" ng-mouseleave="hideDetails()" ng-click="choosePerk(perkDetails, $parent.$index, this)" ng-class="{active: $parent.$index == 0}" >
											<input type="checkbox" name="{{$parent.$index}}" id="{{perkDetails.id}}" > 
											<img src="{{perkDetails.img_src}}" class="pull-left" /> 
											{{perkDetails.title}}
										</label>

									</div>

								</div>

							</div>

						</div>

					</div>
				
					<div class="panel-body" ng-show="visibleTab === 'armory'">
						<div class="row">
							<div class="col-sm-5">Armor</div>
							<div class="col-sm-7">
								<select class="form-control"
										ng-model="selectedArmor"
										ng-options="armor.name group by armor.type for armor in armors"></select>
							</div>
						</div>
						<div class="row">
							<div class="col-sm-5">Primary Weapon</div>
							<div class="col-sm-7">
								<select class="form-control"
										ng-model="selectedPrimaryWeapon"
										ng-options="weapon.name group by weapon.type for weapon in primaryWeapons"></select>
							</div>
						</div>
						<div class="row">
							<div class="col-sm-5">Secondary Weapon</div>
							<div class="col-sm-7">
								<select class="form-control"
										ng-model="selectedSecondaryWeapon"
										ng-options="weapon.name group by weapon.type for weapon in secondaryWeapons"></select>
							</div>
						</div>

						<div class="row">
							<div class="col-sm-5">Equipment</div>
							<div class="col-sm-7">
								<select class="form-control"
										ng-model="equipmentSlotOne"
										ng-options="item.name group by item.type for item in equipment"></select>
							</div>
						</div>
						<div class="row">
							<div class="col-sm-5">Equipment</div>
							<div class="col-sm-7">
								<select class="form-control"
										ng-model="equipmentSlotTwo"
										ng-options="item.name group by item.type for item in equipment"></select>
							</div>
						</div>
					</div>
				
					<div class="panel-body" ng-show="visibleTab === 'psionics' ">
						<div class="row" ng-repeat="rank in psionicsPerks" style="padding: 2px;">
							<div class="col-sm-3">
								{{rank.name}}
							</div>
							<div class="col-sm-9">

								<div class="btn-group btn-group-justified" role="group">
									
									<div class="btn-group" data-toggle="buttons" ng-repeat="perkDetails in rank.perks">
								
										<label class="btn btn-default" ng-mouseover="showDescription(perkDetails.description)" ng-mouseleave="hideDescription()" ng-click="choosePsiPerk(perkDetails, $parent.$index, this)" >
											<input type="checkbox" name="psi{{$parent.$index}}" id="{{perkDetails.id}}" > 
											<img src="{{perkDetails.img_src}}" class="pull-left" /> 
											{{perkDetails.name}}
										</label>

									</div>

								</div>

							</div>

						</div>
					</div>

					<div class="panel-body" ng-show="visibleTab === 'gene' ">
						<div class="row" ng-repeat="slot in geneMods" style="padding: 2px;">
							<div class="col-sm-3">
								{{slot.slot}}
							</div>
							<div class="col-sm-9">

								<div class="btn-group btn-group-justified" role="group">
									
									<div class="btn-group" data-toggle="buttons" ng-repeat="perkDetails in slot.mods">
								
										<label class="btn btn-default" ng-mouseover="showDescription(perkDetails.description)" ng-mouseleave="hideDescription()" ng-click="chooseGeneMod(perkDetails, $parent.$index, this)" >
											<input type="checkbox" name="psi{{$parent.$index}}" id="{{perkDetails.id}}" > 
											<img src="{{perkDetails.img_src}}" class="pull-left" style="width: 32px;" /> 
											{{perkDetails.name}}
										</label>

									</div>

								</div>

							</div>

						</div>
					</div>

					<h4>Build</h4>
					<div class="well well-lg container-fluid">
						<div class="col-lg-5">

							<span ng-repeat="icon in icons">
								<img src="{{icon.img_url}}" alt="{{icon.title}}" style="width: 32px;" ng-mouseover="showDescription(icon.description)" ng-mouseout="hideDescription()" />								
							</span>

						</div>
						<div class="col-lg-7">
							<table class="table table-condensed table-striped" ng-show="equipmentSlotOne != null || equipmentSlotTwo != null">
								<tr>
									<td>{{equipmentSlotOne.name}}</td>
									<td>{{equipmentSlotOne.notes}}</td>
								</tr>
								<tr>
									<td>{{equipmentSlotTwo.name}}</td>
									<td>{{equipmentSlotTwo.notes}}</td>
								</tr>
							</table>
						</div>
					</div>

				</div>
			</div>            
			<div class="col-md-3">

				<form class="form-inline" style="width: 100%;">
  					<div class="form-group pull-right" style="margin-bottom: 3px;">
  						<input type="text" value="{{linkText}}" class="form-control" />
						<button class="btn btn-success" ng-click="buildLink();" >Share this build</button>
  					</div>
  				</form>
				<table class="table table-condensed table-striped">
					<tr>
						<td>HP</td>
						<td>{{build.hp + build.rank_ups.health}} + {{build.armor + selectedArmor.hp + equipmentSlotOne.hp + equipmentSlotTwo.hp}}</td>
						<td>Will</td>
						<td>{{build.will + build.rank_ups.will_low + selectedArmor.will  + equipmentSlotOne.will + equipmentSlotTwo.will }} - {{build.will + build.rank_ups.will_high + selectedArmor.will + equipmentSlotOne.will + equipmentSlotTwo.will}}</td>
					</tr>
					<tr>
						<td>Defense</td>
						<td>{{build.defense + selectedArmor.defense + equipmentSlotOne.defense + equipmentSlotTwo.defense}}</td>
						<td>Damage Reduction</td>
						<td>{{build.damage_reduction + + selectedArmor.damage_reduction + equipmentSlotOne.damage_reduction + equipmentSlotTwo.damage_reduction}}</td>
					</tr>
					<tr>
						<td>Aim</td>
						<td>{{build.aim + build.mod.aim + build.rank_ups.aim + selectedPrimaryWeapon.aim_mod + equipmentSlotOne.aim + equipmentSlotTwo.aim}}</td>
						<td>Mobility</td>
						<td>{{build.mobility + build.mod.mob + selectedPrimaryWeapon.mobility_mod + + selectedArmor.mobility + equipmentSlotOne.mobilitiy + equipmentSlotTwo.mobilitiy}}</td>
					</tr>
				</table>
				<table class="table table-condensed table-striped">
					<tr>
						<td colspan="4">
							Primary Weapon
						</td>
					</tr>
					<tr class="info">
						<td colspan="4">
							{{selectedPrimaryWeapon.name}}
						</td>
					</tr>
					<tr>
						<td>Min Damage</td>
						<td>
							{{selectedPrimaryWeapon.min_damage + build.damage_bonus}}
						</td>
						<td>Max Damage</td>
						<td>
							{{selectedPrimaryWeapon.max_damage + build.damage_bonus}}
						</td>
					</tr>
					<tr>
						<td>Crit Min</td>
						<td>
							{{selectedPrimaryWeapon.crit_damage_min + build.damage_bonus}}
						</td>
						<td>Crit Max</td>
						<td>
							{{selectedPrimaryWeapon.crit_damage_max + build.damage_bonus}}
						</td>
					</tr>
				</table>
				<table class="table table-condensed table-striped">
					<tr>
						<td colspan="4">
							Secondary Weapon
						</td>
					</tr>
					<tr class="info">
						<td colspan="4">
							{{selectedSecondaryWeapon.name}}
						</td>
					</tr>
					<tr>
						<td>Min Damage</td>
						<td>
							{{selectedSecondaryWeapon.min_damage + build.damage_bonus}}
						</td>
						<td>Max Damage</td>
						<td>
							{{selectedSecondaryWeapon.max_damage + build.damage_bonus}}
						</td>
					</tr>
					<tr>
						<td>Crit Min</td>
						<td>
							{{selectedSecondaryWeapon.crit_damage_min + build.damage_bonus}}
						</td>
						<td>Crit Max</td>
						<td>
							{{selectedSecondaryWeapon.crit_damage_max + build.damage_bonus}}
						</td>
					</tr>
				</table>
				<table class="table table-condensed table-striped">
					<tr>
						<td></td>
					</tr>
				</table>
				<div class="alert alert-success" ng-show="showPerkDetails">
					{{perkInDetails.description}}
					<table class="table table-condensed">
						<tr>
							<td>Aim</td>
							<td>Will</td>
							<td>Mobility</td>
						</tr>
						<tr>
							<td>+{{perkInDetails.aim_bonus}}</td>
							<td>+{{perkInDetails.will_bonus}}</td>
							<td>+{{perkInDetails.mobility_bonus}}</td>
						</tr>
					</table>
				</div>
				<div class="alert alert-success" ng-show="displayDescription">
					{{description}}
				</div>
			</div>

		</div>
		
		
	</div>

	<nav class="navbar navbar-default navbar-fixed-bottom">
		<div class="container-fluid">
			<div class="collapse navbar-collapse">
				<p class="navbar-text navbar-left">
					All images and text Copyright Firaxis Games.
				</p>
				<p class="navbar-text navbar-right">
					Michael Pickens, http://www.reddit.com/u/khariq
				</p>
			</div>
		</div>
	</nav>

	<script src="scripts/app.js" type="text/javascript"></script>
	<script src="scripts/Controllers/navController.js" type="text/javascript"></script>
	<script src="scripts/Controllers/buildController.js" type="text/javascript"></script>
	<script src="scripts/Controllers/classController.js" type="text/javascript"></script>

	</body>
</html>